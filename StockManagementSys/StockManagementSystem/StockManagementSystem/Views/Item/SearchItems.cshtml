@using StockManagementSystem.Models.Domain;

@{
    ViewData["Title"] = "SearchItems";

    IEnumerable<Company>? comps = ViewData["comps"] as IEnumerable<Company>;

}

<h1>SearchItems</h1>

<form>
<div class="container">

    <select class="form-select mt-2" id="companyId" onchange="populateItems()">

        @foreach(var item in comps)
             {        
        <option
            onchange="populateItems()"
             id="companyId" value="@item.Id"> @item.Name
        </option>
             } 
    </select>
    <label class="mt-2" id="itemId" style="display:inline;">Email address</label>

    <select class="form-select mt-2" id="itemId" style="display:inline;">
            <option selected>
                >----Select Item----
            </option>
    </select>
</div>
</form>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<script>

 
    //var quantityToChange = document.getElementById('QuantityToChange').value;

    function populateItems() {
        var companyId = $("#companyId").val();
        // Get the selected option element.
        var selectedOption = document.querySelector('#companyId option:checked');

        // Get the text of the selected option element.
        var selectedItemName = selectedOption.textContent;

        // Assign the text of the selected option element to a JavaScript variable.
        //companyname = selectedItemName;

        $.ajax({
            url: "/Item/GetCompanyById",
            data: { companyId: companyId },
            success: function (data) {
                $("#itemId").find('option:enabled').remove(); // Clear the options before appending new ones
                $("#itemId").append('<option value="">select item</option>');
               $(data).each(
        function (key, value) {
            $("#itemId").append('<option value="' + value.id + '">' + value.name + '</option>');
        });
            }
        });
     }
   

         // Call the populateItems() function before the updateItemDetails() function

</script>




